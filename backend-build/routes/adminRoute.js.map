{"version":3,"sources":["../../backend/routes/adminRoute.js"],"names":["router","express","Router","storageA","multer","diskStorage","destination","req","file","cb","filename","fileName","Date","now","originalname","fileFilter","mimetype","Error","upload","storage","get","isAdmin","res","Product","find","products","send","post","isAuth","single","next","mysqlConnection","getConnection","err","connection","sql","query","body","name","category","brand","subcategory","supplier","path","slice","length","price","percentage","availability","description","user","username","countInStock","result","fields","insertedId","insertId","status","message","release","put","collectionId","params","id","Object","keys","image","productVisibility","beginTransaction","productID","commit","rollback","pricePercentage","product","i","_id","idArray","push","ID","console","log","productId","forEach","key","row","manufacturer","manufacturer_id","featureTitle","featureTitleId","titleId","method","cost","methodId","paymentMethod","paymentMethodCost","paymentMethodId","sendingMethodId","title","featureId","parentId","supplier_id","companyId","company","compatibility_company_id","model","compatibility_model_id","compat_id","compatibilities","compatId","isSuperAdmin","bcrypt","hash","password","email","admins","productHistory","compHistory","featHistory","resp","orderId","orderStatusHistory","orderSendingPaymentHistory","billingAddressHistory","shippingAddressHistory","orderProductHistory","itemsPerPage","offset","newsletterList","count"],"mappings":"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","sourcesContent":["import express from 'express';\r\nimport multer from 'multer';\r\nimport bcrypt from 'bcrypt';\r\nimport { isAdmin, isAuth, isSuperAdmin } from '../util';\r\nimport mysqlConnection from '../connection';\r\n\r\nconst router = express.Router();\r\n\r\nconst storageA = multer.diskStorage({\r\n  destination: function (req, file, cb) {\r\n    cb(null, 'frontend/public/images/products')\r\n  },\r\n  filename: (req, file, cb) => {\r\n    const fileName = Date.now() + '-' + file.originalname;\r\n    cb(null, fileName);\r\n  }\r\n});\r\n\r\nconst fileFilter = (req, file, cb) => {\r\n  if (file.mimetype == \"image/png\" || file.mimetype == \"image/jpg\" || file.mimetype == \"image/jpeg\" || file.mimetype == \"image/gif\") {\r\n    cb(null, true);\r\n  } else {\r\n    cb(null, false);\r\n    return cb(new Error('Allowed only .png, .jpg, .jpeg and .gif'));\r\n  }\r\n}\r\n\r\nconst upload = multer({ storage: storageA, fileFilter: fileFilter });\r\n\r\n\r\n\r\nrouter.get(\"/\", isAdmin, async (req, res) => {\r\n  const products = await Product.find({});\r\n  res.send(products);\r\n})\r\n\r\nrouter.post(\"/createproduct\", isAuth, isAdmin, upload.single('image'), async (req, res, next) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    var sql = \"INSERT INTO products (name, category, brand, subcategory, supplier, image, price, percentage,availability, description, CreatedBy, CreatedAt, countInStock) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, 10)\";\r\n    connection.query(sql, [req.body.name, req.body.category, req.body.brand, req.body.subcategory, req.body.supplier, req.file.path.slice(15, req.file.path.length),\r\n    req.body.price, req.body.percentage, req.body.availability, req.body.description, req.user.username, new Date, req.body.countInStock], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      let insertedId = result.insertId\r\n\r\n      sql = \"INSERT INTO productsHistory (product_id, name, category, brand, subcategory, supplier, image, price, percentage, availability, description, CreatedBy, CreatedAt, countInStock) SELECT _id, name, category, brand, subcategory, supplier, image, price, percentage, availability, description, CreatedBy, CreatedAt, countInStock FROM products WHERE _id=?\";\r\n      connection.query(sql, [insertedId], function (err, result, fields) {\r\n        if (err) throw err;\r\n\r\n      })\r\n      res.status(201).send({ message: 'New product Created' });\r\n    });\r\n\r\n    connection.release();\r\n\r\n    // Handle error after the release.\r\n    if (err) throw err;\r\n  });\r\n\r\n})\r\n\r\nrouter.post(\"/getcollectionList\", isAuth, isAdmin, upload.single('image'), async (req, res, next) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    var sql = \"SELECT * FROM products WHERE category=?\";\r\n    connection.query(sql, [\"Συλλογή\"], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      res.status(200).send(result);\r\n    });\r\n\r\n    connection.release();\r\n\r\n    // Handle error after the release.\r\n    if (err) throw err;\r\n  });\r\n\r\n})\r\n\r\nrouter.post(\"/insertcollectionproduct\", isAuth, isAdmin, upload.single('image'), async (req, res, next) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    var sql = \"INSERT INTO products (name, image, price, description, category) VALUES (?, ?, ?, ?, ?)\";\r\n    connection.query(sql, [req.body.name, req.file.path.slice(15, req.file.path.length),\r\n    req.body.price, req.body.description, \"Συλλογή\"], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      res.status(201).send({ message: 'New collection product Created' });\r\n    });\r\n\r\n    connection.release();\r\n\r\n    // Handle error after the release.\r\n    if (err) throw err;\r\n  });\r\n\r\n})\r\n\r\nrouter.put(\"/insertcollectionproduct/:id\", isAuth, isAdmin, upload.single('image'), async (req, res, next) => {\r\n  const collectionId = req.params.id;\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    var sql = 'SELECT * FROM products WHERE _id=?';\r\n    connection.query(sql, [collectionId], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      if (Object.keys(result).length === 0) {\r\n\r\n        res.send({ message: 'Product not found' });\r\n      }\r\n      else {\r\n        sql = \"UPDATE products SET name=?, image=?, price=?, description=? WHERE _id=?\";\r\n        connection.query(sql, [req.body.name, req.body.image, req.body.price, req.body.description, collectionId], function (err, result, fields) {\r\n          if (err) throw err;\r\n\r\n        });\r\n\r\n        sql = \"SELECT * FROM products WHERE _id=?\";\r\n        connection.query(sql, [collectionId], function (err, result, fields) {\r\n          if (err) throw err;\r\n\r\n          res.send(result);\r\n        });\r\n      }\r\n    });\r\n\r\n    connection.release();\r\n\r\n    // Handle error after the release.\r\n    if (err) throw err;\r\n  });\r\n\r\n})\r\n\r\nrouter.put(\"/changeCollectionVisibility\", isAuth, isAdmin, async (req, res, next) => {\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n    var sql = 'UPDATE products SET visibility=? WHERE _id=?';\r\n    connection.query(sql, [req.body.productVisibility, req.body.collectionId], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      sql = \"SELECT * FROM products WHERE _id=?\";\r\n      connection.query(sql, [req.body.collectionId], function (err, result, fields) {\r\n        if (err) throw err;\r\n        res.send(result);\r\n      })\r\n\r\n    });\r\n\r\n    connection.release();\r\n\r\n    // Handle error after the release.\r\n    if (err) throw err;\r\n  });\r\n});\r\n\r\nrouter.put(\"/changeVisibility\", isAuth, isAdmin, async (req, res, next) => {\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n\r\n      var sql = 'UPDATE products SET visibility=? WHERE _id=?';\r\n      connection.query(sql, [req.body.productVisibility, req.body.productID], function (err, result, fields) {\r\n        if (err) throw err;\r\n        // sql = \"INSERT INTO productsHistory (product_id, name, category, brand, subcategory, supplier, image, price, percentage, availability, visibility, description, CreatedBy, CreatedAt, countInStock, UpdatedBy, UpdatedAt) SELECT _id, name, category, brand, subcategory, supplier, image, price, percentage, availability, visibility, description, CreatedBy, CreatedAt, countInStock, ?, ? FROM products WHERE _id=?\";\r\n        // connection.query(sql, [req.user.username, new Date, req.body.productID], function (err, result, fields) {\r\n        //   if (err) {\r\n        //     connection.rollback(function () {\r\n        //       throw err;\r\n        //     });\r\n        //   }\r\n\r\n        sql = \"SELECT * FROM products WHERE _id=?\";\r\n        connection.query(sql, [req.body.productID], function (err, result, fields) {\r\n          if (err) throw err;\r\n\r\n          connection.commit(function (err) {\r\n            if (err) {\r\n              connection.rollback(function () {\r\n                throw err;\r\n              });\r\n            }\r\n            res.send(result);\r\n          })\r\n          // })\r\n        });\r\n      });\r\n    });\r\n    connection.release();\r\n\r\n    // Handle error after the release.\r\n    if (err) throw err;\r\n  });\r\n});\r\n\r\nrouter.put(\"/category_percentage_change\", isAuth, isAdmin, async (req, res, next) => {\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n    if (req.body.supplier === '' || req.body.supplier === 'Επέλεξε Προμηθευτή' || req.body.supplier === null) {\r\n      if (req.body.subcategory === '' || req.body.subcategory === 'Επέλεξε Υποκατηγορία' || req.body.subcategory === null) {\r\n        connection.beginTransaction(function (err) {\r\n          var sql = 'UPDATE products SET percentage=? WHERE category=?';\r\n          connection.query(sql, [req.body.pricePercentage, req.body.category], function (err, result, fields) {\r\n            if (err) throw err;\r\n\r\n            sql = \"INSERT INTO productsHistory (product_id, name, category, brand, subcategory, supplier, image, price, percentage, description, CreatedBy, CreatedAt, countInStock, UpdatedBy, UpdatedAt) SELECT _id, name, category, brand, subcategory, supplier, image, price, percentage, description, CreatedBy, CreatedAt, countInStock, ?, ? FROM products WHERE category=?\";\r\n            connection.query(sql, [req.user.username, new Date, req.body.category], function (err, result, fields) {\r\n              if (err) {\r\n                connection.rollback(function () {\r\n                  throw err;\r\n                });\r\n              }\r\n\r\n              sql = \"SELECT _id FROM products WHERE category=?\";\r\n              connection.query(sql, [req.body.category], function (err, result, fields) {\r\n                if (err) {\r\n                  connection.rollback(function () {\r\n                    throw err;\r\n                  });\r\n                }\r\n\r\n                let product = result;\r\n\r\n                for (let i = 0; i < product.length; i++) {\r\n                  sql = \"SELECT ID FROM productsHistory WHERE product_id=? ORDER BY UpdatedAt DESC LIMIT 5\";\r\n                  connection.query(sql, [product[i]._id], function (err, result, fields) {\r\n                    if (err) {\r\n                      connection.rollback(function () {\r\n                        throw err;\r\n                      });\r\n                    }\r\n\r\n                    let idArray = []\r\n                    for (let i = 0; i < result.length; i++) {\r\n                      idArray.push(result[i].ID)\r\n                    }\r\n\r\n                    sql = \"DELETE FROM productsHistory WHERE product_id=? && ID NOT IN (?)\";\r\n                    connection.query(sql, [product[i]._id, idArray], function (err, result, fields) {\r\n                      if (err) {\r\n                        connection.rollback(function () {\r\n                          throw err;\r\n                        });\r\n                      }\r\n                    })\r\n                  })\r\n                }\r\n\r\n                connection.commit(function (err) {\r\n                  if (err) {\r\n                    connection.rollback(function () {\r\n                      throw err;\r\n                    });\r\n                  }\r\n                  console.log('Transaction Completed Successfully.');\r\n                  res.send({ message: \"OK\" });\r\n                });\r\n              })\r\n            })\r\n          })\r\n        });\r\n      }\r\n      else {\r\n        connection.beginTransaction(function (err) {\r\n          var sql = 'UPDATE products SET percentage=? WHERE category=? && subcategory=?';\r\n          connection.query(sql, [req.body.pricePercentage, req.body.category, req.body.subcategory], function (err, result, fields) {\r\n            if (err) throw err;\r\n\r\n            sql = \"INSERT INTO productsHistory (product_id, name, category, brand, subcategory, supplier, image, price, percentage, description, CreatedBy, CreatedAt, countInStock, UpdatedBy, UpdatedAt) SELECT _id, name, category, brand, subcategory, supplier, image, price, percentage, description, CreatedBy, CreatedAt, countInStock, ?, ? FROM products WHERE category=? && subcategory=?\";\r\n            connection.query(sql, [req.user.username, new Date, req.body.category, req.body.subcategory], function (err, result, fields) {\r\n              if (err) {\r\n                connection.rollback(function () {\r\n                  throw err;\r\n                });\r\n              }\r\n\r\n              sql = \"SELECT _id FROM products WHERE category=? && subcategory=?\";\r\n              connection.query(sql, [req.body.category, req.body.subcategory], function (err, result, fields) {\r\n                if (err) {\r\n                  connection.rollback(function () {\r\n                    throw err;\r\n                  });\r\n                }\r\n\r\n                let product = result;\r\n\r\n                for (let i = 0; i < product.length; i++) {\r\n                  sql = \"SELECT ID FROM productsHistory WHERE product_id=? ORDER BY UpdatedAt DESC LIMIT 5\";\r\n                  connection.query(sql, [product[i]._id], function (err, result, fields) {\r\n                    if (err) {\r\n                      connection.rollback(function () {\r\n                        throw err;\r\n                      });\r\n                    }\r\n\r\n                    let idArray = []\r\n                    for (let i = 0; i < result.length; i++) {\r\n                      idArray.push(result[i].ID)\r\n                    }\r\n\r\n                    sql = \"DELETE FROM productsHistory WHERE product_id=? && ID NOT IN (?)\";\r\n                    connection.query(sql, [product[i]._id, idArray], function (err, result, fields) {\r\n                      if (err) {\r\n                        connection.rollback(function () {\r\n                          throw err;\r\n                        });\r\n                      }\r\n                    })\r\n                  })\r\n                }\r\n\r\n                connection.commit(function (err) {\r\n                  if (err) {\r\n                    connection.rollback(function () {\r\n                      throw err;\r\n                    });\r\n                  }\r\n                  console.log('Transaction Completed Successfully.');\r\n                  res.send({ message: \"OK\" });\r\n                });\r\n              })\r\n            })\r\n          })\r\n        });\r\n      }\r\n    }\r\n    else {\r\n      if (req.body.category === '' || req.body.category === 'Επέλεξε Κατηγορία' || req.body.category === null) {\r\n        connection.beginTransaction(function (err) {\r\n          var sql = 'UPDATE products SET percentage=? WHERE supplier=?';\r\n          connection.query(sql, [req.body.pricePercentage, req.body.supplier], function (err, result, fields) {\r\n            if (err) throw err;\r\n\r\n            sql = \"INSERT INTO productsHistory (product_id, name, category, brand, subcategory, supplier, image, price, percentage, description, CreatedBy, CreatedAt, countInStock, UpdatedBy, UpdatedAt) SELECT _id, name, category, brand, subcategory, supplier, image, price, percentage, description, CreatedBy, CreatedAt, countInStock, ?, ? FROM products WHERE supplier=?\";\r\n            connection.query(sql, [req.user.username, new Date, req.body.supplier], function (err, result, fields) {\r\n              if (err) {\r\n                connection.rollback(function () {\r\n                  throw err;\r\n                });\r\n              }\r\n\r\n              sql = \"SELECT _id FROM products WHERE supplier=?\";\r\n              connection.query(sql, [req.body.supplier], function (err, result, fields) {\r\n                if (err) {\r\n                  connection.rollback(function () {\r\n                    throw err;\r\n                  });\r\n                }\r\n\r\n                let product = result;\r\n\r\n                for (let i = 0; i < product.length; i++) {\r\n                  sql = \"SELECT ID FROM productsHistory WHERE product_id=? ORDER BY UpdatedAt DESC LIMIT 5\";\r\n                  connection.query(sql, [product[i]._id], function (err, result, fields) {\r\n                    if (err) {\r\n                      connection.rollback(function () {\r\n                        throw err;\r\n                      });\r\n                    }\r\n\r\n                    let idArray = []\r\n                    for (let i = 0; i < result.length; i++) {\r\n                      idArray.push(result[i].ID)\r\n                    }\r\n\r\n                    sql = \"DELETE FROM productsHistory WHERE product_id=? && ID NOT IN (?)\";\r\n                    connection.query(sql, [product[i]._id, idArray], function (err, result, fields) {\r\n                      if (err) {\r\n                        connection.rollback(function () {\r\n                          throw err;\r\n                        });\r\n                      }\r\n                    })\r\n                  })\r\n                }\r\n\r\n                connection.commit(function (err) {\r\n                  if (err) {\r\n                    connection.rollback(function () {\r\n                      throw err;\r\n                    });\r\n                  }\r\n                  console.log('Transaction Completed Successfully.');\r\n                  res.send({ message: \"OK\" });\r\n                });\r\n              })\r\n            })\r\n          })\r\n        });\r\n      }\r\n      else {\r\n        if (req.body.subcategory === '' || req.body.subcategory === 'Επέλεξε Υποκατηγορία' || req.body.subcategory === null) {\r\n          connection.beginTransaction(function (err) {\r\n            var sql = 'UPDATE products SET percentage=? WHERE category=? && supplier=?';\r\n            connection.query(sql, [req.body.pricePercentage, req.body.category, req.body.supplier], function (err, result, fields) {\r\n              if (err) throw err;\r\n\r\n              sql = \"INSERT INTO productsHistory (product_id, name, category, brand, subcategory, supplier, image, price, percentage, description, CreatedBy, CreatedAt, countInStock, UpdatedBy, UpdatedAt) SELECT _id, name, category, brand, subcategory, supplier, image, price, percentage, description, CreatedBy, CreatedAt, countInStock, ?, ? FROM products WHERE category=? && supplier=?\";\r\n              connection.query(sql, [req.user.username, new Date, req.body.category, req.body.supplier], function (err, result, fields) {\r\n                if (err) {\r\n                  connection.rollback(function () {\r\n                    throw err;\r\n                  });\r\n                }\r\n\r\n                sql = \"SELECT _id FROM products WHERE category=? && supplier=?\";\r\n                connection.query(sql, [req.body.category, req.body.supplier], function (err, result, fields) {\r\n                  if (err) {\r\n                    connection.rollback(function () {\r\n                      throw err;\r\n                    });\r\n                  }\r\n\r\n                  let product = result;\r\n\r\n                  for (let i = 0; i < product.length; i++) {\r\n                    sql = \"SELECT ID FROM productsHistory WHERE product_id=? ORDER BY UpdatedAt DESC LIMIT 5\";\r\n                    connection.query(sql, [product[i]._id], function (err, result, fields) {\r\n                      if (err) {\r\n                        connection.rollback(function () {\r\n                          throw err;\r\n                        });\r\n                      }\r\n\r\n                      let idArray = []\r\n                      for (let i = 0; i < result.length; i++) {\r\n                        idArray.push(result[i].ID)\r\n                      }\r\n\r\n                      sql = \"DELETE FROM productsHistory WHERE product_id=? && ID NOT IN (?)\";\r\n                      connection.query(sql, [product[i]._id, idArray], function (err, result, fields) {\r\n                        if (err) {\r\n                          connection.rollback(function () {\r\n                            throw err;\r\n                          });\r\n                        }\r\n                      })\r\n                    })\r\n                  }\r\n\r\n                  connection.commit(function (err) {\r\n                    if (err) {\r\n                      connection.rollback(function () {\r\n                        throw err;\r\n                      });\r\n                    }\r\n                    console.log('Transaction Completed Successfully.');\r\n                    res.send({ message: \"OK\" });\r\n                  });\r\n                })\r\n              })\r\n            })\r\n          });\r\n        }\r\n        else {\r\n          connection.beginTransaction(function (err) {\r\n            var sql = 'UPDATE products SET percentage=? WHERE category=? && subcategory=? && supplier=?';\r\n            connection.query(sql, [req.body.pricePercentage, req.body.category, req.body.subcategory, req.body.supplier], function (err, result, fields) {\r\n              if (err) throw err;\r\n\r\n              sql = \"INSERT INTO productsHistory (product_id, name, category, brand, subcategory, supplier, image, price, percentage, description, CreatedBy, CreatedAt, countInStock, UpdatedBy, UpdatedAt) SELECT _id, name, category, brand, subcategory, supplier, image, price, percentage, description, CreatedBy, CreatedAt, countInStock, ?, ? FROM products WHERE category=? && subcategory=? && supplier=?\";\r\n              connection.query(sql, [req.user.username, new Date, req.body.category, req.body.subcategory, req.body.supplier], function (err, result, fields) {\r\n                if (err) {\r\n                  connection.rollback(function () {\r\n                    throw err;\r\n                  });\r\n                }\r\n\r\n                sql = \"SELECT _id FROM products WHERE category=? && subcategory=? && supplier=?\";\r\n                connection.query(sql, [req.body.category, req.body.subcategory, req.body.supplier], function (err, result, fields) {\r\n                  if (err) {\r\n                    connection.rollback(function () {\r\n                      throw err;\r\n                    });\r\n                  }\r\n\r\n                  let product = result;\r\n\r\n                  for (let i = 0; i < product.length; i++) {\r\n                    sql = \"SELECT ID FROM productsHistory WHERE product_id=? ORDER BY UpdatedAt DESC LIMIT 5\";\r\n                    connection.query(sql, [product[i]._id], function (err, result, fields) {\r\n                      if (err) {\r\n                        connection.rollback(function () {\r\n                          throw err;\r\n                        });\r\n                      }\r\n\r\n                      let idArray = []\r\n                      for (let i = 0; i < result.length; i++) {\r\n                        idArray.push(result[i].ID)\r\n                      }\r\n\r\n                      sql = \"DELETE FROM productsHistory WHERE product_id=? && ID NOT IN (?)\";\r\n                      connection.query(sql, [product[i]._id, idArray], function (err, result, fields) {\r\n                        if (err) {\r\n                          connection.rollback(function () {\r\n                            throw err;\r\n                          });\r\n                        }\r\n                      })\r\n                    })\r\n                  }\r\n\r\n                  connection.commit(function (err) {\r\n                    if (err) {\r\n                      connection.rollback(function () {\r\n                        throw err;\r\n                      });\r\n                    }\r\n                    console.log('Transaction Completed Successfully.');\r\n                    res.send({ message: \"OK\" });\r\n                  });\r\n                })\r\n              })\r\n            })\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    connection.release();\r\n\r\n    // Handle error after the release.\r\n    if (err) throw err;\r\n  });\r\n});\r\n\r\nrouter.put(\"/createproduct/:id\", isAuth, isAdmin, upload.single('image'), async (req, res, next) => {\r\n  const productId = req.params.id;\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n\r\n      var sql = 'SELECT * FROM products WHERE _ID=?';\r\n      connection.query(sql, [productId], function (err, result, fields) {\r\n        if (err) {\r\n          connection.rollback(function () {\r\n            throw err;\r\n          });\r\n        }\r\n\r\n        if (Object.keys(result).length === 0) {\r\n\r\n          res.send({ message: 'Product not found' });\r\n          return\r\n        }\r\n\r\n        sql = \"UPDATE products SET name=?, category=?, brand=?, subcategory=?, supplier=?, image=?, price=?, percentage=?, availability=?, description=? WHERE _id=?\";\r\n        connection.query(sql, [req.body.name, req.body.category, req.body.brand, req.body.subcategory, req.body.supplier,\r\n        req.body.image, req.body.price, req.body.percentage, req.body.availability, req.body.description, productId], function (err, result, fields) {\r\n          if (err) {\r\n            connection.rollback(function () {\r\n              throw err;\r\n            });\r\n          }\r\n\r\n          sql = \"INSERT INTO productsHistory (product_id, name, category, brand, subcategory, supplier, image, price, percentage, availability, visibility, description, CreatedBy, CreatedAt, countInStock, UpdatedBy, UpdatedAt) SELECT _id, name, category, brand, subcategory, supplier, image, price, percentage, availability, visibility, description, CreatedBy, CreatedAt, countInStock, ?, ? FROM products WHERE _id=?\";\r\n          connection.query(sql, [req.user.username, new Date, productId], function (err, result, fields) {\r\n            if (err) {\r\n              connection.rollback(function () {\r\n                throw err;\r\n              });\r\n            }\r\n\r\n            sql = \"SELECT ID FROM productsHistory WHERE product_id=? ORDER BY UpdatedAt DESC LIMIT 5\";\r\n            connection.query(sql, [productId], function (err, result, fields) {\r\n              if (err) {\r\n                connection.rollback(function () {\r\n                  throw err;\r\n                });\r\n              }\r\n\r\n              let idArray = []\r\n              for (let i = 0; i < result.length; i++) {\r\n                idArray.push(result[i].ID)\r\n              }\r\n\r\n              sql = \"DELETE FROM productsHistory WHERE product_id=? && ID NOT IN (?)\";\r\n              connection.query(sql, [productId, idArray], function (err, result, fields) {\r\n                if (err) {\r\n                  connection.rollback(function () {\r\n                    throw err;\r\n                  });\r\n                }\r\n\r\n                sql = \"SELECT * FROM products WHERE _id=?\";\r\n                connection.query(sql, [productId], function (err, result, fields) {\r\n                  if (err) {\r\n                    connection.rollback(function () {\r\n                      throw err;\r\n                    });\r\n                  }\r\n\r\n                  let product = {}\r\n\r\n                  if (Object.keys(result).length !== 0) {\r\n                    Object.keys(result).forEach(function (key) {\r\n                      var row = result[key];\r\n                      product = {\r\n                        name: row.name,\r\n                        category: row.category,\r\n                        brand: row.brand,\r\n                        subcategory: row.subcategory,\r\n                        supplier: row.supplier,\r\n                        price: row.price,\r\n                        percentage: row.percentage,\r\n                        description: row.description,\r\n                        countInStock: row.countInStock\r\n                      };\r\n\r\n                    });\r\n                  }\r\n\r\n                  connection.commit(function (err) {\r\n                    if (err) {\r\n                      connection.rollback(function () {\r\n                        throw err;\r\n                      });\r\n                    }\r\n                    console.log('Transaction Completed Successfully.');\r\n                    res.status(200).send(product);\r\n                    connection.release();\r\n                  });\r\n                });\r\n\r\n              })\r\n\r\n            })\r\n\r\n          })\r\n\r\n        });\r\n\r\n      });\r\n    })\r\n\r\n    // Handle error after the release.\r\n    if (err) throw err;\r\n  });\r\n});\r\n\r\nrouter.post(\"/createcategory\", isAuth, isAdmin, upload.single('image'), async (req, res, next) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    var sql = \"INSERT INTO categories (category, image) VALUES (?, ?)\";\r\n    connection.query(sql, [req.body.category, req.file.path.slice(15, req.file.path.length)], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      res.status(201).send({ message: 'New product Created' });\r\n    });\r\n\r\n    connection.release();\r\n\r\n    // Handle error after the release.\r\n    if (err) throw err;\r\n  });\r\n\r\n})\r\n\r\nrouter.post(\"/manufacturerslist\", isAuth, isAdmin, async (req, res) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    connection.query('SELECT * FROM manufacturers ORDER BY name', function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      res.send(result);\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n})\r\n\r\nrouter.post(\"/insertmanufacturer\", isAuth, isAdmin, async (req, res, next) => {\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    /* Begin transaction */\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n\r\n      let sql = \"INSERT INTO manufacturers (name) VALUES (?)\";\r\n      connection.query(sql, [req.body.manufacturer], function (err, result, fields) {\r\n        if (err) {\r\n          connection.rollback(function () {\r\n            throw err;\r\n          });\r\n        }\r\n\r\n        sql = \"SELECT * FROM manufacturers ORDER BY name\";\r\n        connection.query(sql, function (err, result) {\r\n          if (err) {\r\n            connection.rollback(function () {\r\n              throw err;\r\n            });\r\n          }\r\n\r\n          res.send(result);\r\n\r\n          connection.commit(function (err) {\r\n            if (err) {\r\n              connection.rollback(function () {\r\n                throw err;\r\n              });\r\n            }\r\n\r\n            connection.release();\r\n          });\r\n        });\r\n      });\r\n    });\r\n    /* End transaction */\r\n  })\r\n});\r\n\r\nrouter.post(\"/deletemanufacturer\", isAuth, isAdmin, async (req, res, next) => {\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    /* Begin transaction */\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n\r\n      let sql = \"DELETE FROM manufacturers WHERE manufacturer_id=?\";\r\n      connection.query(sql, [req.body.manufacturer_id], function (err, result, fields) {\r\n        if (err) {\r\n          connection.rollback(function () {\r\n            throw err;\r\n          });\r\n        }\r\n\r\n        sql = \"SELECT * FROM manufacturers ORDER BY name\";\r\n        connection.query(sql, function (err, result) {\r\n          if (err) {\r\n            connection.rollback(function () {\r\n              throw err;\r\n            });\r\n          }\r\n\r\n          res.send(result);\r\n\r\n          connection.commit(function (err) {\r\n            if (err) {\r\n              connection.rollback(function () {\r\n                throw err;\r\n              });\r\n            }\r\n\r\n            connection.release();\r\n          });\r\n        });\r\n      });\r\n    });\r\n    /* End transaction */\r\n  })\r\n});\r\n\r\nrouter.post(\"/featuretitlelist\", isAuth, isAdmin, async (req, res) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    connection.query('SELECT * FROM feature_titles ORDER BY feature_title', function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      res.send(result);\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n})\r\n\r\nrouter.post(\"/insertfeaturetitle\", isAuth, isAdmin, async (req, res, next) => {\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    /* Begin transaction */\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n\r\n      let sql = \"INSERT INTO feature_titles (feature_title) VALUES (?)\";\r\n      connection.query(sql, [req.body.featureTitle], function (err, result, fields) {\r\n        if (err) {\r\n          connection.rollback(function () {\r\n            throw err;\r\n          });\r\n        }\r\n\r\n        sql = \"SELECT * FROM feature_titles ORDER BY feature_title\";\r\n        connection.query(sql, function (err, result) {\r\n          if (err) {\r\n            connection.rollback(function () {\r\n              throw err;\r\n            });\r\n          }\r\n\r\n          res.send(result);\r\n\r\n          connection.commit(function (err) {\r\n            if (err) {\r\n              connection.rollback(function () {\r\n                throw err;\r\n              });\r\n            }\r\n\r\n            connection.release();\r\n          });\r\n        });\r\n      });\r\n    });\r\n    /* End transaction */\r\n  })\r\n});\r\n\r\nrouter.post(\"/featurenames\", isAuth, isAdmin, async (req, res) => {\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    var sql = 'SELECT DISTINCT feature_name FROM feature_names WHERE feature_title_id=? ORDER BY feature_name';\r\n    connection.query(sql, [req.body.featureTitleId], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      res.send(result);\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n})\r\n\r\nrouter.post(\"/insertfeaturename\", isAuth, isAdmin, async (req, res, next) => {\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n    /* Begin transaction */\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n\r\n      let sql = \"INSERT INTO feature_names (feature_title_id, feature_name) VALUES (?, ?)\";\r\n      connection.query(sql, [req.body.titleId, req.body.name], function (err, result, fields) {\r\n        if (err) {\r\n          connection.rollback(function () {\r\n            throw err;\r\n          });\r\n        }\r\n\r\n        sql = \"SELECT * FROM feature_names WHERE feature_title_id=? ORDER BY feature_name \";\r\n        connection.query(sql, [req.body.titleId], function (err, result) {\r\n          if (err) {\r\n            connection.rollback(function () {\r\n              throw err;\r\n            });\r\n          }\r\n\r\n          res.send(result);\r\n\r\n          connection.commit(function (err) {\r\n            if (err) {\r\n              connection.rollback(function () {\r\n                throw err;\r\n              });\r\n            }\r\n\r\n            connection.release();\r\n          });\r\n        });\r\n      });\r\n    });\r\n    /* End transaction */\r\n  })\r\n});\r\n\r\nrouter.post(\"/sendinglist\", isAuth, isAdmin, async (req, res) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    connection.query('SELECT * FROM sendingMethods', function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      res.send(result);\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n})\r\n\r\nrouter.post(\"/editsendingmethod\", isAuth, isAdmin, async (req, res) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    connection.query('UPDATE sendingMethods SET sendingMethod=?, sendingMethodCost=? WHERE sendingMethod_id=?',\r\n      [req.body.method, req.body.cost, req.body.methodId], function (err, result, fields) {\r\n        if (err) throw err;\r\n\r\n        let sql = \"SELECT * FROM sendingMethods\";\r\n        connection.query(sql, function (err, result, fields) {\r\n          if (err) throw err;\r\n\r\n          res.send(result);\r\n        })\r\n\r\n        connection.release();\r\n\r\n        // Handle error after the release.\r\n        if (err) throw err;\r\n      })\r\n  });\r\n})\r\n\r\nrouter.post(\"/createsendingmethod\", isAuth, isAdmin, async (req, res) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    let sql = \"INSERT INTO sendingMethods (sendingMethod, sendingMethodCost) VALUES (?, ?)\";\r\n    connection.query(sql, [req.body.method, req.body.cost], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      sql = \"SELECT * FROM sendingMethods\";\r\n      connection.query(sql, function (err, result, fields) {\r\n        if (err) throw err;\r\n\r\n        res.send(result);\r\n      })\r\n\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n})\r\n\r\nrouter.post(\"/removesendingmethod\", isAuth, isAdmin, async (req, res) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    let sql = \"DELETE FROM sendingMethods WHERE sendingMethod_id=?\";\r\n    connection.query(sql, [req.body.methodId], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      sql = \"SELECT * FROM sendingMethods\";\r\n      connection.query(sql, function (err, result, fields) {\r\n        if (err) throw err;\r\n\r\n        res.send(result);\r\n      })\r\n\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n})\r\n\r\nrouter.post(\"/paymentlist\", isAuth, isAdmin, async (req, res) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    let sql = \"SELECT * FROM paymentMethods WHERE sendingMethod_id=? \";\r\n    connection.query(sql, [req.body.methodId], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      res.send(result);\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n})\r\n\r\nrouter.post(\"/editpaymentlist\", isAuth, isAdmin, async (req, res) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    connection.query('UPDATE paymentMethods SET paymentMethod=?, paymentMethodCost=? WHERE paymentMethod_id=?',\r\n      [req.body.paymentMethod, req.body.paymentMethodCost, req.body.paymentMethodId], function (err, result, fields) {\r\n        if (err) throw err;\r\n\r\n        let sql = \"SELECT * FROM paymentMethods WHERE sendingMethod_id=? \";\r\n        connection.query(sql, [req.body.sendingMethodId], function (err, result, fields) {\r\n          if (err) throw err;\r\n\r\n          res.send(result);\r\n        })\r\n\r\n        connection.release();\r\n\r\n        // Handle error after the release.\r\n        if (err) throw err;\r\n      })\r\n  });\r\n})\r\n\r\nrouter.post(\"/createpaymentlist\", isAuth, isAdmin, async (req, res) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    let sql = \"INSERT INTO paymentMethods (paymentMethod, paymentMethodCost,sendingMethod_id) VALUES (?, ?, ?)\";\r\n    connection.query(sql, [req.body.paymentMethod, req.body.paymentMethodCost, req.body.sendingMethodId], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      sql = \"SELECT * FROM paymentMethods WHERE sendingMethod_id=? \";\r\n      connection.query(sql, [req.body.sendingMethodId], function (err, result, fields) {\r\n        if (err) throw err;\r\n\r\n        res.send(result);\r\n      })\r\n\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n})\r\n\r\nrouter.post(\"/removepaymentlist\", isAuth, isAdmin, async (req, res) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    let sql = \"DELETE FROM paymentMethods WHERE paymentMethod_id=?\";\r\n    connection.query(sql, [req.body.paymentMethodId], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      sql = \"SELECT * FROM paymentMethods WHERE sendingMethod_id=? \";\r\n      connection.query(sql, [req.body.sendingMethodId], function (err, result, fields) {\r\n        if (err) throw err;\r\n\r\n        res.send(result);\r\n      })\r\n\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n})\r\n\r\nrouter.post(\"/featurelist\", isAuth, isAdmin, async (req, res) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    connection.query('SELECT * FROM features WHERE product_id=? ORDER BY feature_title,feature', [req.body.productId], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      res.send(result);\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n})\r\n\r\nrouter.post(\"/insertfeature\", isAuth, isAdmin, async (req, res, next) => {\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n    /* Begin transaction */\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n\r\n      let sql = \"INSERT INTO features (product_id, feature_title, feature) VALUES (?, ?, ?)\";\r\n      connection.query(sql, [req.body.productId, req.body.title, req.body.name], function (err, result, fields) {\r\n        if (err) {\r\n          connection.rollback(function () {\r\n            throw err;\r\n          });\r\n        }\r\n        var sql = \"INSERT INTO featuresHistory (product_id, feature_title, feature, UpdatedBy, UpdatedAt, actions) VALUES (?,?,?,?,?,?)\";\r\n        connection.query(sql, [req.body.productId, req.body.title, req.body.name, req.user.username, new Date, \"Προσθήκη\"], function (err, result, fields) {\r\n          if (err) {\r\n            connection.rollback(function () {\r\n              throw err;\r\n            });\r\n          }\r\n\r\n          sql = \"SELECT * FROM features WHERE product_id=? ORDER BY feature_title,feature\";\r\n          connection.query(sql, [req.body.productId], function (err, result) {\r\n            if (err) {\r\n              connection.rollback(function () {\r\n                throw err;\r\n              });\r\n            }\r\n\r\n            res.send(result);\r\n\r\n            connection.commit(function (err) {\r\n              if (err) {\r\n                connection.rollback(function () {\r\n                  throw err;\r\n                });\r\n              }\r\n\r\n            });\r\n          });\r\n        })\r\n      });\r\n      connection.release();\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    });\r\n    /* End transaction */\r\n  })\r\n});\r\n\r\nrouter.post(\"/deletefeature\", isAuth, isAdmin, async (req, res, next) => {\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    /* Begin transaction */\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n\r\n      var sql = \"INSERT INTO featuresHistory (product_id, feature_title, feature, UpdatedBy, UpdatedAt, actions) SELECT  features.product_id, features.feature_title, features.feature, ?, ? , ? FROM features WHERE features_id=?\";\r\n      connection.query(sql, [req.user.username, new Date, \"Διαγραφή\", req.body.featureId], function (err, result, fields) {\r\n        if (err) {\r\n          connection.rollback(function () {\r\n            throw err;\r\n          });\r\n        }\r\n\r\n        let sql = \"DELETE FROM features WHERE features_id=?\";\r\n        connection.query(sql, [req.body.featureId], function (err, result, fields) {\r\n          if (err) {\r\n            connection.rollback(function () {\r\n              throw err;\r\n            });\r\n          }\r\n\r\n          sql = \"SELECT * FROM features WHERE product_id=?\";\r\n          connection.query(sql, [req.body.productId], function (err, result) {\r\n            if (err) {\r\n              connection.rollback(function () {\r\n                throw err;\r\n              });\r\n            }\r\n\r\n            res.send(result);\r\n\r\n            connection.commit(function (err) {\r\n              if (err) {\r\n                connection.rollback(function () {\r\n                  throw err;\r\n                });\r\n              }\r\n            });\r\n          });\r\n        });\r\n      });\r\n      connection.release();\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    });\r\n    /* End transaction */\r\n  })\r\n});\r\n\r\nrouter.post(\"/categories\", isAuth, isAdmin, async (req, res) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    connection.query('SELECT * FROM categories ORDER BY category', function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      res.send(result);\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n})\r\n\r\nrouter.post(\"/subcategories\", isAuth, isAdmin, async (req, res) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n    connection.query('SELECT * FROM categories WHERE parent_id=? ORDER BY category', [req.body.parentId], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      res.send(result);\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n})\r\n\r\nrouter.post(\"/suppliers\", isAuth, isAdmin, async (req, res) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n    connection.query('SELECT * FROM suppliers ORDER BY supplier', function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      res.send(result);\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n})\r\n\r\nrouter.post(\"/insertsupplier\", isAuth, isAdmin, async (req, res, next) => {\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    /* Begin transaction */\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n\r\n      let sql = \"INSERT INTO suppliers (supplier) VALUES (?)\";\r\n      connection.query(sql, [req.body.supplier], function (err, result, fields) {\r\n        if (err) {\r\n          connection.rollback(function () {\r\n            throw err;\r\n          });\r\n        }\r\n\r\n        sql = \"SELECT * FROM suppliers ORDER BY supplier\";\r\n        connection.query(sql, function (err, result) {\r\n          if (err) {\r\n            connection.rollback(function () {\r\n              throw err;\r\n            });\r\n          }\r\n\r\n          res.send(result);\r\n\r\n          connection.commit(function (err) {\r\n            if (err) {\r\n              connection.rollback(function () {\r\n                throw err;\r\n              });\r\n            }\r\n\r\n            connection.release();\r\n          });\r\n        });\r\n      });\r\n    });\r\n    /* End transaction */\r\n  })\r\n});\r\n\r\nrouter.post(\"/deletesupplier\", isAuth, isAdmin, async (req, res, next) => {\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    /* Begin transaction */\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n\r\n      let sql = \"DELETE FROM suppliers WHERE supplier_id=?\";\r\n      connection.query(sql, [req.body.supplier_id], function (err, result, fields) {\r\n        if (err) {\r\n          connection.rollback(function () {\r\n            throw err;\r\n          });\r\n        }\r\n\r\n        sql = \"SELECT * FROM suppliers ORDER BY supplier\";\r\n        connection.query(sql, function (err, result) {\r\n          if (err) {\r\n            connection.rollback(function () {\r\n              throw err;\r\n            });\r\n          }\r\n\r\n          res.send(result);\r\n\r\n          connection.commit(function (err) {\r\n            if (err) {\r\n              connection.rollback(function () {\r\n                throw err;\r\n              });\r\n            }\r\n\r\n            connection.release();\r\n          });\r\n        });\r\n      });\r\n    });\r\n    /* End transaction */\r\n  })\r\n});\r\n\r\nrouter.post(\"/compatibilitycompanylist\", isAuth, isAdmin, async (req, res) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n    connection.query('SELECT * FROM compatibility_company ORDER BY company', function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      res.send(result);\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n})\r\n\r\nrouter.post(\"/compatibilitymodelslist\", isAuth, isAdmin, async (req, res) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n    connection.query('SELECT * FROM compatibility_model WHERE compatibility_company_id=? ORDER BY model', [req.body.companyId], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      res.send(result);\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n})\r\n\r\nrouter.post(\"/insertcompatibilitycompany\", isAuth, isAdmin, async (req, res, next) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    var sql = \"INSERT INTO compatibility_company (company) VALUES (?)\";\r\n    connection.query(sql, [req.body.company], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      let compatibility_company_id = result.insertId;\r\n\r\n      sql = \"SELECT * FROM compatibility_company WHERE compatibility_company_id=?\";\r\n      connection.query(sql, [compatibility_company_id], function (err, result, fields) {\r\n        if (err) throw err;\r\n\r\n        res.status(201).send(result);\r\n      });\r\n    });\r\n\r\n\r\n    connection.release();\r\n\r\n    // Handle error after the release.\r\n    if (err) throw err;\r\n  });\r\n\r\n})\r\n\r\nrouter.post(\"/insertcompatibilitymodel\", isAuth, isAdmin, async (req, res, next) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    var sql = \"INSERT INTO compatibility_model (compatibility_company_id,model) VALUES (?,?)\";\r\n    connection.query(sql, [req.body.companyId, req.body.model], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      let compatibility_model_id = result.insertId;\r\n\r\n      sql = \"SELECT * FROM compatibility_model WHERE compatibility_model_id=?\";\r\n      connection.query(sql, [compatibility_model_id], function (err, result, fields) {\r\n        if (err) throw err;\r\n\r\n        res.status(201).send(result);\r\n      });\r\n    });\r\n\r\n\r\n    connection.release();\r\n\r\n    // Handle error after the release.\r\n    if (err) throw err;\r\n  });\r\n\r\n})\r\n\r\nrouter.post(\"/insertcompatibility\", isAuth, isAdmin, async (req, res, next) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n\r\n      var sql = \"INSERT INTO compatibilities (product_id,compatibility_company,compatibility_model) VALUES (?,?,?)\";\r\n      connection.query(sql, [req.body.productId, req.body.company, req.body.model], function (err, result, fields) {\r\n        if (err) {\r\n          connection.rollback(function () {\r\n            throw err;\r\n          });\r\n        }\r\n\r\n        let compat_id = result.insertId;\r\n\r\n        var sql = \"INSERT INTO compatibilitiesHistory (product_id, compatibility_company, compatibility_model, UpdatedBy, UpdatedAt, actions) VALUES (?,?,?,?,?,?)\";\r\n        connection.query(sql, [req.body.productId, req.body.company, req.body.model, req.user.username, new Date, \"Προσθήκη\"], function (err, result, fields) {\r\n          if (err) {\r\n            connection.rollback(function () {\r\n              throw err;\r\n            });\r\n          }\r\n\r\n          sql = \"SELECT * FROM compatibilities WHERE compatibility_id=? ORDER BY compatibility_company ASC, compatibility_model ASC\";\r\n          connection.query(sql, [compat_id], function (err, result, fields) {\r\n            if (err) {\r\n              connection.rollback(function () {\r\n                throw err;\r\n              });\r\n            }\r\n\r\n            const compatibilities = result;\r\n\r\n            connection.commit(function (err) {\r\n              if (err) {\r\n                connection.rollback(function () {\r\n                  throw err;\r\n                });\r\n              }\r\n              res.status(201).send(compatibilities);\r\n              console.log('Transaction Completed Successfully.');\r\n            });\r\n          });\r\n        });\r\n      });\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n\r\n})\r\n\r\nrouter.post(\"/getproductcompatibilities\", isAuth, isAdmin, async (req, res, next) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    var sql = \"SELECT * FROM compatibilities WHERE product_id=? ORDER BY compatibility_company ASC,compatibility_model ASC\";\r\n    connection.query(sql, [req.body.productId], function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      res.status(200).send(result);\r\n\r\n    })\r\n    connection.release();\r\n    // Handle error after the release.\r\n    if (err) throw err;\r\n  });\r\n\r\n})\r\n\r\nrouter.post(\"/deletecompatibility\", isAuth, isAdmin, async (req, res, next) => {\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n\r\n      var sql = \"INSERT INTO compatibilitiesHistory (product_id, compatibility_company, compatibility_model, UpdatedBy, UpdatedAt, actions) SELECT  compatibilities.product_id, compatibilities.compatibility_company, compatibilities.compatibility_model, ?, ? , ? FROM compatibilities WHERE compatibility_id=?\";\r\n      connection.query(sql, [req.user.username, new Date, \"Διαγραφή\", req.body.compatId], function (err, result, fields) {\r\n        if (err) {\r\n          connection.rollback(function () {\r\n            throw err;\r\n          });\r\n        }\r\n\r\n        var sql = \"DELETE FROM compatibilities WHERE compatibility_id=?\";\r\n        connection.query(sql, [req.body.compatId], function (err, result, fields) {\r\n          if (err) {\r\n            connection.rollback(function () {\r\n              throw err;\r\n            });\r\n          }\r\n\r\n          connection.commit(function (err) {\r\n            if (err) {\r\n              connection.rollback(function () {\r\n                throw err;\r\n              });\r\n            }\r\n            res.status(200).send({ message: \"OK\" });\r\n            console.log('Transaction Completed Successfully.');\r\n          });\r\n        })\r\n      })\r\n    })\r\n    connection.release();\r\n    // Handle error after the release.\r\n    if (err) throw err;\r\n  });\r\n\r\n})\r\n\r\nrouter.post(\"/getAdmins\", isAuth, isAdmin, isSuperAdmin, async (req, res) => {\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    var sql = 'SELECT username, email, isAdmin FROM users WHERE isAdmin=1 ORDER BY username';\r\n    connection.query(sql, function (err, result, fields) {\r\n      if (err) throw err;\r\n\r\n      res.send(result);\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    })\r\n  });\r\n})\r\n\r\nrouter.post(\"/insertAdmin\", isAuth, isAdmin, isSuperAdmin, async (req, res) => {\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n\r\n      bcrypt.hash(req.body.password, 10, (err, hash) => {\r\n        // Store hash in your password DB.\r\n\r\n        var sql = \"INSERT INTO users (username,email,password,isAdmin) VALUES (?,?,?,?)\";\r\n        connection.query(sql, [req.body.username, req.body.email, hash, \"1\"], function (err, result, fields) {\r\n          if (err) {\r\n            connection.rollback(function () {\r\n              throw err;\r\n            });\r\n          }\r\n\r\n          sql = 'SELECT username, email, isAdmin FROM users WHERE isAdmin=1 ORDER BY username';\r\n          connection.query(sql, function (err, result, fields) {\r\n            if (err) {\r\n              connection.rollback(function () {\r\n                throw err;\r\n              });\r\n            }\r\n\r\n            var admins = result;\r\n\r\n            connection.commit(function (err) {\r\n              if (err) {\r\n                connection.rollback(function () {\r\n                  throw err;\r\n                });\r\n              }\r\n              res.send(admins);\r\n            });\r\n          })\r\n        });\r\n      });\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    });\r\n  });\r\n})\r\n\r\nrouter.post(\"/deleteAdmin\", isAuth, isAdmin, isSuperAdmin, async (req, res) => {\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n      var sql = \"DELETE FROM users WHERE email=?\";\r\n      connection.query(sql, [req.body.email], function (err, result, fields) {\r\n        if (err) {\r\n          connection.rollback(function () {\r\n            throw err;\r\n          });\r\n        }\r\n\r\n        sql = 'SELECT username, email, isAdmin FROM users WHERE isAdmin=1 ORDER BY username';\r\n        connection.query(sql, function (err, result, fields) {\r\n          if (err) {\r\n            connection.rollback(function () {\r\n              throw err;\r\n            });\r\n          }\r\n\r\n          var admins = result;\r\n\r\n          connection.commit(function (err) {\r\n            if (err) {\r\n              connection.rollback(function () {\r\n                throw err;\r\n              });\r\n            }\r\n            res.send(admins);\r\n          });\r\n        })\r\n      });\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    });\r\n  });\r\n})\r\n\r\nrouter.post(\"/getProductHistory\", isAuth, isAdmin, isSuperAdmin, async (req, res) => {\r\n  const productId = req.body.productId;\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n      var sql = \"SELECT * FROM productsHistory WHERE product_id=? ORDER BY UpdatedAt DESC\";\r\n      connection.query(sql, [productId], function (err, result, fields) {\r\n        if (err) {\r\n          connection.rollback(function () {\r\n            throw err;\r\n          });\r\n        }\r\n\r\n        let productHistory = result;\r\n\r\n        sql = \"SELECT * FROM compatibilitiesHistory WHERE product_id=? ORDER BY UpdatedAt DESC\";\r\n        connection.query(sql, [productId], function (err, result, fields) {\r\n          if (err) {\r\n            connection.rollback(function () {\r\n              throw err;\r\n            });\r\n          }\r\n\r\n          let compHistory = result;\r\n\r\n          sql = \"SELECT * FROM featuresHistory WHERE product_id=? ORDER BY UpdatedAt DESC\";\r\n          connection.query(sql, [productId], function (err, result, fields) {\r\n            if (err) {\r\n              connection.rollback(function () {\r\n                throw err;\r\n              });\r\n            }\r\n\r\n            let featHistory = result;\r\n\r\n            connection.commit(function (err) {\r\n              if (err) {\r\n                connection.rollback(function () {\r\n                  throw err;\r\n                });\r\n              }\r\n              let resp = { productHistory, compHistory, featHistory }\r\n              res.send(resp);\r\n            });\r\n          })\r\n        })\r\n      });\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    });\r\n  });\r\n})\r\n\r\nrouter.post(\"/getOrderHistory\", isAuth, isAdmin, isSuperAdmin, async (req, res) => {\r\n  const orderId = req.body.orderId;\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n      var sql = \"SELECT * FROM orderStatusHistory WHERE order_id=? ORDER BY UpdatedAt DESC\";\r\n      connection.query(sql, [orderId], function (err, result, fields) {\r\n        if (err) {\r\n          connection.rollback(function () {\r\n            throw err;\r\n          });\r\n        }\r\n\r\n        let orderStatusHistory = result;\r\n\r\n        sql = \"SELECT * FROM orderSendingPaymentHistory WHERE order_id=? ORDER BY UpdatedAt DESC\";\r\n        connection.query(sql, [orderId], function (err, result, fields) {\r\n          if (err) {\r\n            connection.rollback(function () {\r\n              throw err;\r\n            });\r\n          }\r\n\r\n          let orderSendingPaymentHistory = result;\r\n\r\n          sql = \"SELECT * FROM billingAddressHistory WHERE order_id=? ORDER BY UpdatedAt DESC\";\r\n          connection.query(sql, [orderId], function (err, result, fields) {\r\n            if (err) {\r\n              connection.rollback(function () {\r\n                throw err;\r\n              });\r\n            }\r\n\r\n            let billingAddressHistory = result;\r\n\r\n            sql = \"SELECT * FROM shippingAddressHistory WHERE order_id=? ORDER BY UpdatedAt DESC\";\r\n            connection.query(sql, [orderId], function (err, result, fields) {\r\n              if (err) {\r\n                connection.rollback(function () {\r\n                  throw err;\r\n                });\r\n              }\r\n\r\n              let shippingAddressHistory = result;\r\n\r\n              sql = \"SELECT orderProductHistory.product_id, orderProductHistory.model, orderProductHistory.quantity, orderProductHistory.image_case, orderProductHistory.UpdatedBy, orderProductHistory.UpdatedAt, orderProductHistory.actions, products.name, products.category, products.brand, products.image FROM orderProductHistory INNER JOIN products ON orderProductHistory.product_id=products._id  WHERE orderProductHistory.order_id=? ORDER BY orderProductHistory.product_id , UpdatedAt DESC\";\r\n              connection.query(sql, [orderId], function (err, result, fields) {\r\n                if (err) {\r\n                  connection.rollback(function () {\r\n                    throw err;\r\n                  });\r\n                }\r\n\r\n                let orderProductHistory = result;\r\n\r\n                connection.commit(function (err) {\r\n                  if (err) {\r\n                    connection.rollback(function () {\r\n                      throw err;\r\n                    });\r\n                  }\r\n                  let resp = { orderStatusHistory, orderSendingPaymentHistory, billingAddressHistory, shippingAddressHistory, orderProductHistory }\r\n                  res.send(resp);\r\n                });\r\n              });\r\n            })\r\n          })\r\n        })\r\n      });\r\n      connection.release();\r\n\r\n      // Handle error after the release.\r\n      if (err) throw err;\r\n    });\r\n  });\r\n})\r\n\r\nrouter.post(\"/newsletterlist\", isAuth, isAdmin, async (req, res) => {\r\n\r\n  mysqlConnection.getConnection(function (err, connection) {\r\n    if (err) throw err; // not connected!\r\n\r\n    connection.beginTransaction(function (err) {\r\n      if (err) { throw err; }\r\n\r\n      var sql = 'SELECT * FROM newsletters ORDER BY email LIMIT ? OFFSET ?';\r\n      connection.query(sql, [req.body.itemsPerPage, req.body.offset], function (err, result, fields) {\r\n        if (err) {\r\n          connection.rollback(function () {\r\n            throw err;\r\n          });\r\n        }\r\n\r\n        let newsletterList = result;\r\n\r\n        connection.query('SELECT COUNT(*) AS count FROM newsletters',\r\n          function (err, result, fields) {\r\n            if (err) throw err;\r\n            let count = result;\r\n\r\n            connection.commit(function (err) {\r\n              if (err) {\r\n                connection.rollback(function () {\r\n                  throw err;\r\n                });\r\n              }\r\n              res.send({ newsletterList, count });\r\n            });\r\n            connection.release();\r\n\r\n            // Handle error after the release.\r\n            if (err) throw err;\r\n          })\r\n      })\r\n    });\r\n  });\r\n})\r\n\r\n\r\n\r\n\r\nexport default router;"],"file":"adminRoute.js"}